# Text Space Restoration with BERT

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–∞—Ö. –Ø –ø—Ä–æ–±–æ–≤–∞–ª –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ NLP-–º–µ—Ç–æ–¥—ã, –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä BPE, LTSM, RandomForestClassifier —Å –ø–æ–¥–±–æ—Ä–æ–º –ø–æ—Ä–æ–≥–∞, –æ–¥–Ω–∞–∫–æ –≤—Å–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ –Ω–∏–∑–∫–∏–π f1 –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ, –≤—ã–±–æ—Ä –ø–∞–ª –Ω–∞ BERT. –î–æ–ø—É—Å–∫–∞—é —á—Ç–æ –µ—Å—Ç—å —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è –≤ —Ä–∞–∑—ã –ª–µ–≥—á–µ —Å –º–µ–Ω—å—à–µ–π –∑–∞—Ç—Ä–∞—Ç–æ–π —Ä–µ—Å—É—Ä—Å–æ–≤.


---

## –®–∞–≥–∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ—Ä–ø—É—Å–∞
- –í –ø–∞–ø–∫–µ `news_raw/texts` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–∑ –∫–æ—Ä–ø—É—Å–∞ Taiga https://tatianashavrina.github.io/taiga_site/downloads
- –í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `news_raw/texts` —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª `corpus.txt`.
- HTML-—Ç–µ–≥–∏ (`script`, `style`) —É–¥–∞–ª—è—é—Ç—Å—è.
- –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è.
- –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ—Ä–ø—É—Å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã.

### 2. –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –° –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `razdel` —Ç–µ–∫—Å—Ç—ã —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.
- –û—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–º–µ–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤).
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞.

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:
  - –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç,
  - —Ç–µ–∫—Å—Ç –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤,
  - –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–±–µ–ª–æ–≤.
- –î–∞—Ç–∞—Å–µ—Ç –¥–µ–ª–∏—Ç—Å—è –Ω–∞:
  - `train` ‚Äî –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞,
  - `val` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞,
  - `test` ‚Äî —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞.
- –£–¥–∞–ª—è—é—Ç—Å—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –º–µ–∂–¥—É –≤—ã–±–æ—Ä–∫–∞–º–∏.
- CSV-—Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `data`:
  - `data/train.csv`
  - `data/val.csv`
  - `data/test.csv`

### 4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫
- –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è —Å—Ç—Ä–æ–∫–∏ –¥–ª–∏–Ω–æ–π –¥–æ `MAX_LEN/2`.
- –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö.

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –¥–ª—è PyTorch
- **SpaceDataset**:
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç—ã –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–±–µ–ª–æ–≤.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `input_ids`, `attention_mask` –∏ –º–µ—Ç–∫–∏ (`labels`) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.
- –°–æ–∑–¥–∞—é—Ç—Å—è `DataLoader` –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

### 6. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
- –ú–æ–¥–µ–ª—å: `BertForTokenClassification` —Å 2 –∫–ª–∞—Å—Å–∞–º–∏ (–ø—Ä–æ–±–µ–ª / –Ω–µ –ø—Ä–æ–±–µ–ª).
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: `AdamW`.
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: `CrossEntropyLoss`.
- –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ GPU –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ (`device = cuda`).

### 7. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –§—É–Ω–∫—Ü–∏–∏:
  - `train_epoch` ‚Äî –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–π —ç–ø–æ—Ö–µ.
  - `validate` ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å –∏ F1 –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
- –î–ª—è –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏:
  - –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å.
  - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤.
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ F1.

### 8. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–µ—Ç—Å—è **TaskDataset** –¥–ª—è –ª—é–±—ã—Ö –Ω–æ–≤—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤.
- –ü—Ä–æ–≥–æ–Ω —á–µ—Ä–µ–∑ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å (`model.eval()`).
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –ø–æ–∑–∏—Ü–∏—è–º.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `submission.csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
  - `id`
  - `text_no_spaces`
  - `predicted_positions`
  - `predicted_text`


---

## üîπ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### 1. –°–Ω–∞—á–∞–ª–∞ —Å–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/<–≤–∞—à_–ª–æ–≥–∏–Ω>/<–Ω–∞–∑–≤–∞–Ω–∏–µ_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>.git

---
### 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞: 
```bash
git clone https://github.com/<–≤–∞—à_–ª–æ–≥–∏–Ω>/<–Ω–∞–∑–≤–∞–Ω–∏–µ_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>.git
---
## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã GPU

- **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**:
    - GPU: NVIDIA RTX 3080 / 12 GB VRAM
    - –û–±—É—á–µ–Ω–∏–µ –Ω–∞ `BATCH_SIZE=16`, `MAX_LEN=128`
    - –í—Ä–µ–º—è –æ–¥–Ω–æ–π —ç–ø–æ—Ö–∏: ~4 –º–∏–Ω—É—Ç—ã

- **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö)**:
    - GPU: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –∫–∞—Ä—Ç—É, –Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –∏ CPU
    - –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ ~0.5‚Äì2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ 1000 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫
